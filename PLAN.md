# План наведения порядка в проектах Gestalt и Kpalch

## Текущая ситуация

### Проекты:
1. **gestalt** (Go) - оригинальный проект
   - Локально: `/Users/koyash/golang/gestalt-temp`
   - GitHub: https://github.com/Mosl1k/gestalt
   - Статус: есть изменения в `.github/workflows/deploy.yml` и `services/telegram-bot/telegram_bot.py`

2. **kpalch** (Django) - мигрированный проект
   - Локально: `/Users/koyash/Yandex.Disk.localized/gestalt/kpalch.ru`
   - GitHub: https://github.com/Mosl1k/kpalch
   - Статус: много неотслеживаемых файлов, нет миграций для Friendship/SharedList

3. **Сервер** (root@vdska)
   - Папка: `geshtalt`
   - Нужно проверить актуальность версии

## Проблемы

1. ❌ **kpalch**: Нет миграций для моделей Friendship и SharedList (функции друзей и шаринга не работают)
2. ❌ **kpalch**: Много неотслеживаемых файлов в git
3. ❌ **kpalch**: Не синхронизирован с GitHub
4. ❓ **gestalt**: Нужно проверить актуальность версии в GitHub
5. ❓ **Сервер**: Нужно проверить актуальность версии

## План действий

### Этап 1: Проверка и синхронизация gestalt (Go проект)
- [ ] Проверить изменения в gestalt-temp
- [ ] Закоммитить изменения в gestalt (если нужно)
- [ ] Убедиться что актуальная рабочая версия с docker-compose в GitHub
- [ ] Проверить что сервисы alice и telegram-bot актуальны

### Этап 2: Исправление kpalch (Django проект)
- [ ] Создать миграции для Friendship и SharedList моделей
- [ ] Проверить что все функции работают (друзья, шаринг, массовое удаление)
- [ ] Настроить .gitignore для правильного игнорирования файлов
- [ ] Добавить все новые файлы в git
- [ ] Закоммитить изменения в kpalch

### Этап 3: Синхронизация с GitHub
- [ ] Запушить kpalch в GitHub
- [ ] Проверить что версии совпадают

### Этап 4: Проверка сервера
- [ ] Подключиться к root@vdska
- [ ] Проверить версию в папке geshtalt
- [ ] Синхронизировать с GitHub если нужно

### Этап 5: Настройка локального тестирования
- [ ] Создать docker-compose для локального тестирования (без OAuth)
- [ ] Настроить тестовые данные
- [ ] Документировать процесс локального тестирования

### Этап 6: Умный деплой для kpalch
- [ ] Адаптировать smart-deploy.sh из gestalt для kpalch
- [ ] Учесть различия (Go vs Django, Redis vs PostgreSQL)
- [ ] Протестировать умный деплой

## Приоритеты

1. **Критично**: Создать миграции для Friendship/SharedList (иначе функции не работают)
2. **Важно**: Синхронизировать kpalch с GitHub
3. **Важно**: Проверить и синхронизировать сервер
4. **Желательно**: Настроить локальное тестирование
5. **Желательно**: Умный деплой для kpalch

## Заметки

- Функции друзей, шаринга списков и массового удаления **есть в коде**, но не работают из-за отсутствия миграций
- В gestalt есть умный скрипт деплоя (smart-deploy.sh), который нужно адаптировать для kpalch
- На сервере используется Docker Compose, нужно убедиться что версия актуальна

